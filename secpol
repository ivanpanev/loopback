    - name: Determine current GNID once
      set_fact:
        current_gnid: >-
          {{
              (hostvars[inventory_hostname].extra_vars.RequestDetails.GNID
                 if (hostvars[inventory_hostname].extra_vars is defined
                     and hostvars[inventory_hostname].extra_vars.RequestDetails is defined)
                 else RequestDetails.GNID)
          }}
      no_log: true          # keep the token out of the log if you like
